<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Runner Coin</title>

<style>
body {
  margin: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  background: #ddd;
  font-family: Arial, sans-serif;
}

/* GAME */
#game {
  position: relative;
  width: 360px;
  height: 600px;
  background: #f5f5f5;
  overflow: hidden;
  border: 2px solid #333;
}

/* LANES */
.lane {
  position: absolute;
  width: 100%;
  height: 2px;
  background: #ccc;
}
#lane1 { top: 200px; }
#lane2 { top: 300px; }
#lane3 { top: 400px; }

/* PLAYER */
#player {
  position: absolute;
  width: 20px;
  height: 40px;
  left: 80px;
  background: transparent;
}
#player::before {
  content: "";
  position: absolute;
  top: -18px;
  left: 1px;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  border: 2px solid #000;
}
#player::after {
  content: "";
  position: absolute;
  top: 2px;
  left: 9px;
  width: 2px;
  height: 36px;
  background: #000;
}

/* COIN */
.coin {
  position: absolute;
  width: 30px;
  height: 30px;
  background: gold;
  border-radius: 50%;
  right: -40px;
  display: none;
}

/* UI */
#ui {
  position: absolute;
  top: 10px;
  left: 10px;
  font-size: 16px;
}

#afk {
  position: absolute;
  bottom: 10px;
  right: 10px;
  padding: 6px 12px;
}
</style>
</head>

<body>

<div id="game">
  <div id="ui">
    <div id="score">Score: 0</div>
    <div id="highScore">High Score: 0</div>
  </div>

  <button id="afk">AFK</button>

  <div class="lane" id="lane1"></div>
  <div class="lane" id="lane2"></div>
  <div class="lane" id="lane3"></div>

  <div id="player"></div>
  <div class="coin"></div>
</div>

<script>
const lanes = [180, 280, 380];
let currentLane = 1;

const player = document.getElementById("player");
const coin = document.querySelector(".coin");

let score = 0;
let highScore = localStorage.getItem("highScore") || 0;

document.getElementById("highScore").innerText =
  "High Score: " + highScore;

player.style.top = lanes[currentLane] + "px";

/* MOVE PLAYER */
function updatePlayer() {
  player.style.top = lanes[currentLane] + "px";
}

/* SPAWN COIN */
function spawnCoin() {
  const lane = Math.floor(Math.random() * 3);
  coin.style.top = lanes[lane] + "px";
  coin.style.right = "-40px";
  coin.style.display = "block";
}
setInterval(spawnCoin, 2000);

/* MOVE COIN */
function moveCoin() {
  if (coin.style.display === "block") {
    let right = parseInt(coin.style.right);
    coin.style.right = right + 5 + "px";

    if (right > 400) {
      coin.style.display = "none";
    }
  }
}

/* COLLISION */
function checkCollision() {
  const p = player.getBoundingClientRect();
  const c = coin.getBoundingClientRect();

  if (
    p.left < c.right &&
    p.right > c.left &&
    p.top < c.bottom &&
    p.bottom > c.top
  ) {
    score++;
    document.getElementById("score").innerText = "Score: " + score;
    coin.style.display = "none";
  }
}

/* GAME LOOP */
setInterval(() => {
  moveCoin();
  checkCollision();
}, 16);

/* KEYBOARD */
document.addEventListener("keydown", e => {
  if (e.key === "ArrowUp" && currentLane > 0) {
    currentLane--;
    updatePlayer();
  }
  if (e.key === "ArrowDown" && currentLane < 2) {
    currentLane++;
    updatePlayer();
  }
});

/* TOUCH (SWIPE) */
let startY = 0;
document.addEventListener("touchstart", e => {
  startY = e.touches[0].clientY;
});
document.addEventListener("touchend", e => {
  let endY = e.changedTouches[0].clientY;
  if (startY - endY > 40 && currentLane > 0) {
    currentLane--;
  } else if (endY - startY > 40 && currentLane < 2) {
    currentLane++;
  }
  updatePlayer();
});

/* SAVE HIGH SCORE */
window.addEventListener("beforeunload", () => {
  if (score > highScore) {
    localStorage.setItem("highScore", score);
  }
});
</script>

</body>
</html>
